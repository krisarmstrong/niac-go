// Network In A Can - Configuration with Injected Errors
// Author: Kris Armstrong <kris.armstrong@me.com>
//
// This example demonstrates various network problems:
// - High FCS errors
// - High packet discards
// - High interface errors
// - High CPU utilization
// - Recent device reboot

// Device 1: Cisco Switch with FCS and Interface Errors
Device(
    IpAddr(192.168.1.10)
    MacAddr(00AA11BB22C1)
    Vlan(1)
    SnmpAgent(
        // Inject FCS errors (ifInErrors) - increases over time
        AddMib("1.3.6.1.2.1.2.2.1.14.1", "varimib", "(0 50)(6000 150)(12000 450)")

        // Inject output errors
        AddMib("1.3.6.1.2.1.2.2.1.20.1", "varimib", "(0 20)(6000 75)(12000 200)")

        // Inject packet discards
        AddMib("1.3.6.1.2.1.2.2.1.13.1", "varimib", "(0 100)(6000 300)(12000 650)")
        AddMib("1.3.6.1.2.1.2.2.1.19.1", "varimib", "(0 45)(6000 180)(12000 420)")

        // High CPU utilization (Cisco)
        AddMib("1.3.6.1.4.1.9.9.109.1.1.1.1.5.1", "varimib", "(0 85)(6000 90)(12000 95)")

        // Use error-injected walk file (created with inject-errors.py)
        // Include("device_walks/cisco/Catalyst2950-errors.walk")

        // Or use original walk - errors defined above will override
        Include("device_walks/cisco/Catalyst2950_192.168.1.10.walk")
    )
)

// Device 2: Router with Recent Reboot
Device(
    IpAddr(192.168.1.1)
    MacAddr(00AA11BB22C2)
    SnmpAgent(
        // Recent reboot - low sysUpTime (5 minutes = 30000 hundredths)
        AddMib("1.3.6.1.2.1.1.3.0", "varimib", "(0 30000)(60000 90000)")

        // Spanning tree topology changes
        AddMib("1.3.6.1.2.1.17.2.3.0", "varimib", "(0 5)(6000 12)(12000 25)")

        Include("device_walks/cisco/Router_192.168.1.1.walk")
    )
)

// Device 3: Device with Half-Duplex Interface
Device(
    IpAddr(192.168.1.20)
    MacAddr(00AA11BB22C3)
    SnmpAgent(
        // Set duplex to half-duplex (2) instead of full-duplex (3)
        // This is a static value, not dynamic
        Include("device_walks/cisco/Switch_192.168.1.20-halfduplex.walk")
    )
)

// Device 4: High Memory and Disk Utilization
Device(
    IpAddr(192.168.1.30)
    MacAddr(00AA11BB22C4)
    SnmpAgent(
        // High memory usage - 90% used
        AddMib("1.3.6.1.4.1.9.9.48.1.1.1.5.1", "varimib", "(0 450000000)(6000 480000000)")
        AddMib("1.3.6.1.4.1.9.9.48.1.1.1.6.1", "varimib", "(0 50000000)(6000 20000000)")

        // High disk usage - 95%
        AddMib("1.3.6.1.2.1.25.2.3.1.6.1", "varimib", "(0 9500000)(6000 9800000)")

        Include("device_walks/cisco/Router_192.168.1.30.walk")
    )
)

// Device 5: Duplicate IP Address (same IP as Device 1)
Device(
    IpAddr(192.168.1.10)  // Duplicate!
    MacAddr(00AA11BB22C5)  // Different MAC
    SnmpAgent(
        Include("device_walks/cisco/Switch_192.168.1.50.walk")
    )
)

// Device 6: Bad Subnet Mask
Device(
    IpAddr(192.168.1.40)
    MacAddr(00AA11BB22C6)
    SnmpAgent(
        // Wrong subnet mask - should be 255.255.255.0, using 255.255.0.0
        // Note: This would need to be in the walk file itself
        Include("device_walks/cisco/Switch_192.168.1.40-badmask.walk")
    )
)
