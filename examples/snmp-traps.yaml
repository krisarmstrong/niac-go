# SNMP Trap Configuration Example
# Demonstrates SNMP trap generation configuration (v1.6.0)

devices:
  # Router with comprehensive trap configuration
  - name: router-with-traps
    mac: "00:11:22:33:44:01"
    ip: "192.168.1.1"

    # SNMP agent configuration
    snmp_agent:
      # Trap configuration
      traps:
        enabled: true
        receivers:
          - "192.168.1.100:162"    # Management station 1
          - "192.168.1.101:162"    # Management station 2

        # Cold Start trap - sent when device starts
        cold_start:
          enabled: true
          on_startup: true         # Send immediately on startup

        # Link State traps - sent when interfaces go up/down
        link_state:
          enabled: true
          link_down: true          # Send trap on link down
          link_up: true            # Send trap on link up

        # Authentication Failure trap
        authentication_failure:
          enabled: true
          on_startup: false        # Don't send on startup

        # High CPU utilization trap
        high_cpu:
          enabled: true
          threshold: 80            # Trigger at 80% CPU
          interval: 300            # Check every 5 minutes

        # High Memory utilization trap
        high_memory:
          enabled: true
          threshold: 90            # Trigger at 90% memory
          interval: 300            # Check every 5 minutes

        # Interface Errors trap
        interface_errors:
          enabled: true
          threshold: 100           # Trigger at 100 errors
          interval: 60             # Check every minute

    lldp:
      enabled: true
      system_description: "Router with SNMP trap monitoring"

  # Switch with selective trap configuration
  - name: switch-critical-only
    mac: "00:11:22:33:44:02"
    ip: "192.168.1.10"

    snmp_agent:
      traps:
        enabled: true
        receivers:
          - "192.168.1.100:162"

        # Only critical traps enabled
        cold_start:
          enabled: true
          on_startup: true

        link_state:
          enabled: true
          link_down: true          # Only link down (critical)
          link_up: false           # Don't notify on link up

        # Disable threshold-based traps
        high_cpu:
          enabled: false

        high_memory:
          enabled: false

        interface_errors:
          enabled: false

  # Server with threshold monitoring only
  - name: server-with-monitoring
    mac: "00:11:22:33:44:03"
    ip: "192.168.1.20"

    snmp_agent:
      traps:
        enabled: true
        receivers:
          - "192.168.1.100:162"

        # Disable event-based traps
        cold_start:
          enabled: false

        link_state:
          enabled: false

        authentication_failure:
          enabled: false

        # Enable only threshold monitoring
        high_cpu:
          enabled: true
          threshold: 90            # Higher threshold for server
          interval: 60             # More frequent checks

        high_memory:
          enabled: true
          threshold: 95            # Very high threshold
          interval: 60

        interface_errors:
          enabled: true
          threshold: 50            # Lower threshold (more sensitive)
          interval: 30             # Check every 30 seconds

  # Device with traps disabled
  - name: device-no-traps
    mac: "00:11:22:33:44:04"
    ip: "192.168.1.30"

    snmp_agent:
      traps:
        enabled: false             # All trap generation disabled

# Configuration Notes:
# ====================
#
# SNMP Trap Configuration:
# - enabled (bool): Master switch for all trap generation
# - receivers (array): List of trap receiver addresses in "IP:port" format
#   - Standard SNMP trap port is 162
#   - Multiple receivers supported (sent to all)
#
# Trap Types:
#
# 1. Cold Start (coldStart - OID 1.3.6.1.6.3.1.1.5.1):
#    - Sent when device initializes/boots
#    - on_startup: Send immediately when device starts
#    - Use for device availability monitoring
#
# 2. Link State (linkDown/linkUp - OID 1.3.6.1.6.3.1.1.5.3/4):
#    - linkDown: Interface goes down (critical event)
#    - linkUp: Interface comes back up (recovery event)
#    - Use for network connectivity monitoring
#
# 3. Authentication Failure (authenticationFailure - OID 1.3.6.1.6.3.1.1.5.5):
#    - Sent when invalid community string is used
#    - Security event monitoring
#    - on_startup: Can send test trap on startup
#
# 4. High CPU (Threshold-based):
#    - threshold: CPU utilization percentage (0-100)
#    - interval: Check interval in seconds
#    - Sends trap when CPU exceeds threshold
#
# 5. High Memory (Threshold-based):
#    - threshold: Memory utilization percentage (0-100)
#    - interval: Check interval in seconds
#    - Sends trap when memory exceeds threshold
#
# 6. Interface Errors (Threshold-based):
#    - threshold: Error count per check interval
#    - interval: Check interval in seconds
#    - Sends trap when error count exceeds threshold
#
# Trap Receivers:
# ===============
# - Format: "IP:port" or "hostname:port"
# - Standard port: 162 (SNMPv2c traps)
# - Can specify multiple receivers
# - All configured receivers get all enabled traps
#
# Best Practices:
# ===============
#
# 1. Network Devices (Routers/Switches):
#    - Enable cold_start and link_state traps
#    - Set high_cpu threshold: 80-90%
#    - Set high_memory threshold: 90-95%
#    - Check interval: 300s (5 minutes)
#
# 2. Servers:
#    - Enable threshold traps only
#    - Higher CPU threshold (90-95%)
#    - More frequent checks (60-120s)
#    - Lower interface_errors threshold
#
# 3. Critical Infrastructure:
#    - Enable all traps
#    - Multiple receivers for redundancy
#    - Shorter check intervals
#
# 4. Lab/Testing:
#    - Enable on_startup traps for immediate feedback
#    - Lower thresholds to trigger easily
#    - Single receiver sufficient
#
# Threshold Recommendations:
# ==========================
# - CPU: 70% (warning), 85% (critical)
# - Memory: 80% (warning), 95% (critical)
# - Errors: 10/min (warning), 100/min (critical)
# - Check intervals: 300s (normal), 60s (critical)
#
# Testing:
# ========
# - Use tcpdump to capture traps: sudo tcpdump -i any port 162
# - Configure snmptrapd to receive traps
# - Test with: snmptrapd -f -Lo -c /dev/null
