# NIAC-Go v1.5.0 Feature Analysis and Priorities

**Target Release:** Q1 2025
**Status:** Planning Phase

## Overview

v1.5.0 will focus on configuration enhancements, improved debugging capabilities, and additional protocol features that didn't make it into v1.4.0.

## Proposed Features (from CHANGELOG/Unreleased)

### 1. Per-Protocol Debug Level Control ⭐⭐⭐
**Priority:** HIGH
**Effort:** Medium (2-3 days)
**Impact:** High - Better debugging experience

**Description:**
Allow different debug levels for each protocol, so users can debug specific protocols without flooding output.

**Implementation:**
```go
// Example usage:
./niac --debug-dhcp 3 --debug-snmp 2 --debug-arp 1 eth0 config.yaml
```

**Benefits:**
- Focused debugging on specific protocols
- Reduces noise in debug output
- Better troubleshooting experience

**Files to modify:**
- `cmd/niac/main.go` - Add per-protocol debug flags
- `pkg/protocols/stack.go` - Pass debug levels to each handler
- All protocol handlers - Use protocol-specific debug level

---

### 2. Color-Coded Debug Output ⭐⭐⭐
**Priority:** HIGH
**Effort:** Low (1 day)
**Impact:** High - Improved readability

**Description:**
Add color coding to debug output for better visual parsing.

**Color Scheme:**
- **Red** - Errors
- **Yellow** - Warnings
- **Green** - Success/OK
- **Blue** - Info
- **Cyan** - Protocol names
- **Magenta** - Device names

**Implementation:**
Use a lightweight color library like `fatih/color` or `charmbracelet/lipgloss`.

**Files to modify:**
- Add color utility package
- Update all `fmt.Printf` debug statements with colors

---

### 3. Additional Traffic Patterns ⭐⭐
**Priority:** MEDIUM
**Effort:** Medium (2-3 days)
**Impact:** Medium - Enhanced simulation realism

**Description:**
Add more realistic traffic patterns beyond current gratuitous ARP, pings, and random traffic.

**New Patterns:**
1. **DNS Query Pattern** - Periodic DNS lookups
2. **HTTP Request Pattern** - Periodic HTTP GET requests
3. **SNMP Polling Pattern** - Simulated SNMP manager polls
4. **DHCP Renewal Pattern** - Periodic DHCP lease renewals
5. **NetBIOS Browsing** - Periodic NetBIOS name broadcasts
6. **Multicast Groups** - Join/leave multicast groups periodically

**Configurable via YAML:**
```yaml
traffic_patterns:
  dns_queries:
    enabled: true
    interval: 300s
    targets: ["dns.example.com", "www.example.com"]

  http_requests:
    enabled: true
    interval: 600s
    targets: ["http://192.168.1.1"]

  snmp_polling:
    enabled: true
    interval: 30s
    oids: ["1.3.6.1.2.1.1.1.0", "1.3.6.1.2.1.1.3.0"]
```

---

### 4. IPv6 as Primary Device Address ⭐⭐
**Priority:** MEDIUM
**Effort:** Medium (2-4 days)
**Impact:** Medium - Better IPv6 support

**Description:**
Currently IPv6 is supported but IPv4 is primary. Allow devices to have IPv6 as the primary address.

**Current State:**
```yaml
devices:
  - name: "server1"
    ip: "192.168.1.10"        # IPv4 required
    # IPv6 is secondary
```

**Target State:**
```yaml
devices:
  - name: "server1"
    ip: "2001:db8::10"        # IPv6 as primary

  - name: "server2"
    ip: "192.168.1.20"        # IPv4 still supported
```

**Files to modify:**
- `pkg/config/config.go` - Allow IPv6 parsing as primary
- All protocol handlers - Check if primary is IPv4 or IPv6

---

### 5. Multiple IPs per Device ⭐⭐⭐
**Priority:** HIGH
**Effort:** Medium (2-3 days)
**Impact:** High - More realistic simulation

**Description:**
Real devices often have multiple IPs (management, data plane, virtual IPs). Support this in NIAC.

**Target Configuration:**
```yaml
devices:
  - name: "router1"
    ips:
      - "192.168.1.1"
      - "192.168.2.1"
      - "10.0.0.1"
      - "2001:db8::1"
    interfaces:
      - name: "eth0"
        ip: "192.168.1.1"
      - name: "eth1"
        ip: "192.168.2.1"
```

**Benefits:**
- Multi-homed devices
- Virtual IPs
- Multiple subnets per device
- More realistic network topologies

---

### 6. DHCPv6 Prefix Delegation (IA_PD) ⭐
**Priority:** LOW
**Effort:** High (4-5 days)
**Impact:** Medium - Complete DHCPv6 feature set

**Description:**
Add DHCPv6 Prefix Delegation (RFC 8415) for IPv6 prefix assignment to routers.

**Use Case:**
ISP assigns /56 prefix to customer router, router delegates /64 to internal networks.

**Complexity:**
- Requires prefix pool management
- Lease tracking for prefixes
- Renewal/rebind logic
- May be overkill for most NIAC use cases

**Recommendation:** Defer to v1.6.0 unless specifically requested.

---

### 7. HTTP/FTP Server Config in YAML ⭐⭐
**Priority:** MEDIUM
**Effort:** Medium (2-3 days)
**Impact:** Medium - Better customization

**Description:**
Currently HTTP/FTP servers are hardcoded. Allow YAML configuration.

**Target Configuration:**
```yaml
devices:
  - name: "webserver"
    http_server:
      enabled: true
      port: 80
      endpoints:
        - path: "/"
          response: "Welcome to NIAC"
        - path: "/api/status"
          response_file: "responses/status.json"

    ftp_server:
      enabled: true
      port: 21
      banner: "NIAC FTP Server Ready"
      allow_anonymous: true
```

---

### 8. SNMP Trap Generation ⭐⭐
**Priority:** MEDIUM
**Effort:** Medium (3-4 days)
**Impact:** Medium - Complete SNMP implementation

**Description:**
Add SNMP trap/notification sending capability.

**Features:**
- SNMPv2c traps
- SNMPv3 informs
- Configurable trap OIDs
- Periodic or event-triggered traps

**Configuration:**
```yaml
devices:
  - name: "switch1"
    snmp_traps:
      enabled: true
      manager: "192.168.1.100"
      community: "public"
      traps:
        - oid: "1.3.6.1.6.3.1.1.5.3"  # linkDown
          interval: 3600s
        - oid: "1.3.6.1.6.3.1.1.5.4"  # linkUp
          interval: 3600s
```

---

### 9. NetFlow/IPFIX Export ⭐
**Priority:** LOW
**Effort:** High (5-7 days)
**Impact:** Low - Niche feature

**Description:**
Add NetFlow v5/v9 or IPFIX flow export capability.

**Recommendation:** Defer to v2.0.0 or later. This is a complex feature with limited use cases for NIAC.

---

## Recommended v1.5.0 Feature Set

Based on priority, effort, and impact, here's the recommended scope for v1.5.0:

### Phase 1 (1 week)
1. ✅ Color-coded debug output (1 day)
2. ✅ Per-protocol debug level control (2-3 days)
3. ✅ Multiple IPs per device (2-3 days)

### Phase 2 (1 week)
4. ✅ HTTP/FTP server config in YAML (2-3 days)
5. ✅ IPv6 as primary device address (2-3 days)

### Phase 3 (Optional - 1 week)
6. ✅ Additional traffic patterns (2-3 days)
7. ✅ SNMP trap generation (3-4 days)

### Deferred to v1.6.0+
- DHCPv6 Prefix Delegation (complex, niche)
- NetFlow/IPFIX export (very complex, niche)

## Estimated Timeline

- **Minimal v1.5.0:** 1-2 weeks (Phase 1 only)
- **Standard v1.5.0:** 2-3 weeks (Phase 1 + 2)
- **Full v1.5.0:** 3-4 weeks (All phases)

## Risk Assessment

**Low Risk:**
- Color-coded output (well-tested libraries)
- Per-protocol debug (straightforward implementation)

**Medium Risk:**
- Multiple IPs per device (requires protocol handler updates)
- HTTP/FTP YAML config (parsing and validation complexity)

**High Risk:**
- Traffic patterns (potential performance impact)
- SNMP traps (timing and reliability concerns)

## Success Criteria

v1.5.0 will be considered successful if:
1. ✅ All Phase 1 features implemented and tested
2. ✅ No performance regression
3. ✅ Documentation updated
4. ✅ Example configurations provided
5. ✅ Backward compatible with v1.4.0 configs

## Next Steps

1. **User feedback** - Which features are most important?
2. **Prioritize** - Finalize feature list based on feedback
3. **Design** - Create detailed design docs for complex features
4. **Implement** - Start with Phase 1 features
5. **Test** - Comprehensive testing as features complete
6. **Document** - Update docs alongside implementation

---

**Document Status:** Draft
**Author:** Kris Armstrong
**Last Updated:** January 5, 2025
