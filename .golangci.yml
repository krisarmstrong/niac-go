run:
  timeout: 5m
  tests: true
  modules-download-mode: readonly

linters:
  enable:
    - errcheck      # Check for unchecked errors
    - gosimple      # Simplify code
    - govet         # Go vet examines Go source code
    - ineffassign   # Detect ineffectual assignments
    - staticcheck   # Go static analysis
    - unused        # Check for unused code
    - gofmt         # Check code formatting
    - goimports     # Check import formatting
    - misspell      # Detect misspelled English words
    - revive        # Fast, configurable, extensible linter
    - gosec         # Security checker
    - gocyclo       # Cyclomatic complexity
    - dupl          # Code duplication
    - goconst       # Find repeated strings that could be constants
    - unconvert     # Unnecessary type conversions
    - unparam       # Unused function parameters
    - nakedret      # Naked returns in long functions
    - prealloc      # Find slice declarations that could be preallocated
    - exportloopref # Check for pointers to loop variables
    - nilerr        # Check nil err and return nil
    - noctx         # HTTP requests without context
    - rowserrcheck  # Check if sql.Rows.Err is checked
    - sqlclosecheck # Check if sql.Rows/Stmt are closed
    - bodyclose     # Check HTTP body is closed
    - errorlint     # Error wrapping checker

linters-settings:
  errcheck:
    check-type-assertions: true
    check-blank: true

  gocyclo:
    min-complexity: 15

  goconst:
    min-len: 3
    min-occurrences: 3

  dupl:
    threshold: 150

  revive:
    rules:
      - name: exported
        disabled: false
      - name: package-comments
        disabled: true  # Don't require package comments
      - name: unexported-return
        disabled: true
      - name: indent-error-flow
        disabled: false
      - name: var-naming
        disabled: false
        arguments:
          - ["ID", "IP", "MAC", "DNS", "HTTP", "DHCP", "SNMP", "CDP", "LLDP", "STP", "FTP", "ARP", "TLV", "PDU", "MIB", "OID", "UDP", "TCP", "ICMP"] # Allow common network acronyms

  gosec:
    excludes:
      - G104  # Allow unhandled errors in some places (covered by errcheck)
      - G304  # Allow file path from variable (needed for config loading)

issues:
  exclude-rules:
    # Exclude some linters from test files
    - path: _test\.go
      linters:
        - gocyclo
        - errcheck
        - dupl
        - gosec
        - goconst

    # Exclude vendor directories
    - path: vendor/
      linters:
        - all

  max-issues-per-linter: 50
  max-same-issues: 3

output:
  format: colored-line-number
  print-issued-lines: true
  print-linter-name: true
  sort-results: true
